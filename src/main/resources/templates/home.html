<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.0/themes/base/jquery-ui.css"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/ShipStyle.css}" />
    <script th:src="@{/js/jquery/jquery-1.12.4.js}"></script>
    <script th:src="@{/js/jquery/jquery-ui.js}"></script>
    <script th:src="@{/js/accounting/accounting.js}"></script>
    <title>WoWS Fitting Tool by Aesis</title>
</head>
<body>
<header>
    <div id="dropDownList">
        <ul id="shipList">
        </ul>
    </div>
</header>
<main>
</main>
<script th:inline="javascript" th:src="@{/js/WoWSSSC/HashMap.js}"></script>
<script th:inline="javascript" th:src="@{/js/WoWSSSC/Variables.js}"></script>
<script th:inline="javascript">
//    <![CDATA[

    var shipNation = [[${shipNation}]];
    var shipListJSON = [[${shipListJSON}]];
    var nationsMap = new HashMap();
    var nationsList = [];
    var typesList = [];

    $().ready(function () {
        makeMenu();

        $( function() {
            $( "#shipList" ).menu();
        });
    });

    function makeMenu()
    {
        getLists();

        var shipList = document.getElementById('shipList');

        for (var i = 0; i < nationsList.length; i++)
        {
            var nation = document.createElement('li');
            var ul1 = document.createElement('ul');
            nation.innerHTML = '<span>' + nationsList[i] + '</span>';

            for (var j = 0; j < typesList.length; j++)
            {
                var type = document.createElement('li');
                var ul2 = document.createElement('ul');
                type.innerHTML = '<span>' + typesList[j] + '</span>';

                var ships = [];

                for (var k in shipListJSON[nationsList[i]][typesList[j]])
                {
                    ships.push(k);
                }
                ships.sort();

                for (var l = 0; l < ships.length; l++)
                {
                    var ship = document.createElement('li');
                    ship.innerHTML = '<span onclick="getShipInfo(\'' + nationsList[i] + '\', \'' + typesList[j] + '\', \'' + ships[l] + '\')">' + ships[l] + '</span>';
                    ul2.appendChild(ship);
                }

                type.appendChild(ul2);
                ul1.appendChild(type);
            }
            nation.appendChild(ul1);
            shipList.appendChild(nation);
        }
    }

    function getLists()
    {
        for (var i in shipListJSON)
        {
            nationsMap.put(i, shipListJSON[i]);
            nationsList.push(i);

            for (var j in shipListJSON[i])
            {
                typesList.push(j);
            }
        }
        nationsList.sort();

        typesList = typesList.filter(function (elem, index, self) {
            return index == self.indexOf(elem);
        });
        typesList.sort();
    }

    function getShipInfo(nation, type, name)
    {
        var ship = shipListJSON[nation][type][name];
        console.log(ship);

        var modules_tree = ship['modules_tree'];

        for (var i in modules_tree)
        {
            var value = modules_tree[i];
            var name = modules_tree[i]['name'];
            if (value['type'] == 'Artillery')
            {
                artilleryName.push(name);
                artilleryHashMap.put(name, value);
            }
            else if (value['type'] == 'DiveBomber')
            {

            }
            else if (value['type'] == 'Engine')
            {

            }
            else if (value['type'] == 'Fighter')
            {

            }
            else if (value['type'] == 'Suo')
            {

            }
            else if (value['type'] == 'FlightControl')
            {

            }
            else if (value['type'] == 'Hull')
            {

            }
            else if (value['type'] == 'Torpedoes')
            {

            }
            else if (value['type'] == 'TorpedoBombers')
            {

            }
        }

        artilleryName.sort();

    }



//    ]]>
</script>
</body>
</html>